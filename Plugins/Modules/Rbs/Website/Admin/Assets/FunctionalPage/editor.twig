<form name="form" data-ng-submit="submit()" class="form-horizontal" novalidate>
	<fieldset data-ng-show="section==''"
		data-form-section-label="{{ i18nAttr('m.rbs.admin.general-properties', ['ucf']) }}"
		data-form-section-group="{{ i18nAttr('m.rbs.admin.properties', ['ucf']) }}">

		<rbs-field-picker property="website" required="true" label="{{ i18nAttr('m.rbs.website.document.functionalpage.website', ['ucf']) }}"
			accepted-model="Rbs_Website_Website"
			selector-title="{{ i18nAttr('m.rbs.website.document.functionalpage.website-picker-title', ['ucf']) }}"
			allow-edition="true">
			<span class="help-block">{{ i18n('m.rbs.website.document.functionalpage.website-picker-title', ['ucf']) }}</span>
		</rbs-field-picker>

		<hr />

		<rbs-field-text
			property="label" required="true"
			label="{{ i18nAttr('m.rbs.website.document.functionalpage.label', ['ucf']) }}">
		</rbs-field-text>

		<rbs-field-text label="{{ i18nAttr('m.rbs.website.document.functionalpage.title', ['ucf']) }}"
			property="title"
			rbs-sync-value="document.label"
			sync-title="{{ i18nAttr('m.rbs.website.document.functionalpage.synchronize-title-label', ['ucf']) }}"
			required="true">
		</rbs-field-text>

		<rbs-field-picker property="pageTemplate" required="true" label="{{ i18nAttr('m.rbs.website.document.functionalpage.pagetemplate', ['ucf']) }}"
			accepted-model="Rbs_Theme_PageTemplate"
			selector-title="{{ i18nAttr('m.rbs.website.document.functionalpage.pagetemplate-picker-title', ['ucf']) }}"
			allow-edition="true">
		</rbs-field-picker>

		<hr />

		<rbs-field label="{{ i18nAttr('m.rbs.website.document.functionalpage.editablecontent', ['ucf']) }}">
			<button class="btn" type="button" data-ng-click="editPage($event, document)">
				<i class="icon-edit"></i>
				{{ i18n('m.rbs.website.document.functionalpage.open-page-editor', ['ucf']) }}
			</button>
			<span class="help-block">
				{{ i18n('m.rbs.website.document.functionalpage.content-zones', ['ucf', 'lab']) }}
				<span ng-repeat="zone in editableContentInfo" class="label">(=zone=)</span>
			</span>
		</rbs-field>

		<div data-role="edit-page-contents-confirmation"></div>

		<div rbs-tip="Rbs_Website_FunctionalPageEditorFunctions">
			{{ i18n('m.rbs.website.document.functionalpage.functional-page-editor-help') }}
		</div>
	</fieldset>

	<fieldset data-ng-show="section=='functions'"
	          data-form-section-label="{{ i18nAttr('m.rbs.website.document.functionalpage.functions', ['ucf']) }}"
	          data-form-section-group="{{ i18nAttr('m.rbs.admin.properties', ['ucf']) }}">

		<div class="control-group property">

			<span class="help-block">
				{{ i18n('m.rbs.website.document.functionalpage.all-functions-list') }}
			</span>

			<select multiple="multiple" class="input-block-level" size="10"
			        ng-model="document.allowedFunctionsCode"
			        ng-options="value as func.label+' ('+value+')' for (value, func) in allFunctions">
				<option value="">-</option>
			</select>

			<div ng-if="hasAvailableFunctions()">
				{{ i18n('m.rbs.website.document.functionalpage.page-contains-blocks-for-following-functions') }}
				<ul>
					<li ng-repeat="(value, func) in availableFunctions">(= func.label =)<em class="muted"> ((= value =))</em></li>
				</ul>
			</div>
			<div class="alert" ng-if="! hasAvailableFunctions() && ! warningFunctions">
				{{ i18n('m.rbs.website.document.functionalpage.page-contains-no-function') }}
			</div>

			<div ng-if="document.allowedFunctionsCode">
				<div ng-if="!warningFunctions" class="alert alert-success">
					{{ i18n('m.rbs.website.document.functionalpage.page-contains-required-blocks') }}
				</div>

				<div ng-if="warningFunctions" class="alert">
					{{ i18n('m.rbs.website.document.functionalpage.following-functions-cannot-be-supported-correctly') }}
					<ul>
						<li ng-repeat="(value, func) in warningFunctions">(= func.label =)<em class="muted"> ((= value =))</em></li>
					</ul>
					{{ i18n('m.rbs.website.document.functionalpage.edit-page-contents-to-fix-this') }}
				</div>
			</div>
		</div>

	</fieldset>

	<fieldset data-ng-show="section=='systeminfo'"
		data-form-section-label="{{ i18nAttr('m.rbs.admin.Status', ['ucf']) }}"
		data-form-section-group="{{ i18nAttr('m.rbs.admin.Information', ['ucf']) }}"
		data-document-system-info-section>
	</fieldset>

	<form-button-bar></form-button-bar>
</form>