<div data-ng-controller="Change_Website_TopicListController">
	<page-header sub-title="{{ i18nAttr('m.change.website.document.topic-list', ['ucf']) }}"></page-header>

	<search-filters model="Change_Website_StaticPage" query="DL.query" text-search="textSearch"></search-filters>

	<document-list-toolbar></document-list-toolbar>

	<div class="alert alert-info" data-ng-show="DL.documents.length == 0 && ! DL.loading">
		<h4>{{ i18n('m.change.admin.lists.this-list-is-empty', ['ucf']) }}</h4>
		{{ i18n('m.change.admin.lists.you-can', ['ucf', 'lab']) }}
		<ul>
			<li>{{ i18n('m.change.admin.lists.create-elements-with-buttons') }}</li>
			<li ng-show="DL.hasFilters()"><a href="javascript:;" ng-click="DL.cancelFilters()">{{ i18n('m.change.admin.lists.clear-search-filters') }}</a></li>
		</ul>
	</div>

	<table
		data-ng-show="DL.documents.length" class="document-list table table-condensed table-bordered table-striped table-hover data-ng-cloak">
		<thead>
			<tr>
				<th style="text-align: center; width: 30px;"><input type="checkbox" data-ng-model="DL.cbSelectAll" data-ng-change="DL.toggleSelectAll()" /></th>
				<th data-ng-repeat="column in DL.columns" style="text-align: (=column.align=); width: (=column.width=);" data-ng-class="{true:'sorted'}[DL.isSortedOn(column.id)]"><a
					data-ng-show="column.sortable" href data-ng-href="(=DL.headerUrl(column.id)=)">(=column.label=) <i class="column-sort-indicator"
						data-ng-class="{true:'icon-sort-down', false:'icon-sort-up'}[DL.sort.descending]" data-ng-show="DL.isSortedOn(column.id)"></i>
				</a><span data-ng-hide="column.sortable">(=column.label=)</span></th>
			</tr>
		</thead>

		<tbody>
			<tr ng-animate="'animate'" data-ng-repeat="doc in DL.documents" data-ng-class="{'selected': doc.selected, 'success': doc.publicationStatus=='PUBLISHABLE' && ! DL.isPreview(doc), 'warning': doc.publicationStatus=='DEACTIVATED'}">

				<td colspan="7" ng-if="DL.isPreview(doc)" class="preview">
					<span ng-if="DL.isPreviewReady(doc)" ng-bind-html-unsafe="doc.document | documentProperties:doc.modelInfo"></span>
				</td>

				<td style="text-align: center;" ng-if="! DL.isPreview(doc)">
					<input type="checkbox" data-ng-model="doc.selected" data-ng-click="DL.checkDocumentRow($event, $index, doc)" data-docid="(=doc.id=)"/>
				</td>
				<td style="text-align: center" ng-if="! DL.isPreview(doc)">
					<status data-ng-model="doc"/>
				</td>

				<td style="text-align: center;" ng-if="! DL.isPreview(doc)">
					<span data-ng-show="doc.is('Change_Website_Topic') && doc.nodeHasChildren()" class="iconoverlay" title="Éléments dans cette rubrique : (=doc.nodeChildrenCount()=)">
						<i class="icon-2x icon-folder-close"></i>
						<label>(=doc.nodeChildrenCount() | maxNumber=)</label>
					</span>
					<i data-ng-show="doc.is('Change_Website_Topic') && ! doc.nodeHasChildren()" class="icon-2x icon-folder-close-alt"></i>

					<span data-ng-show="doc.is('Change_Website_StaticPage')" class="iconoverlay">
						<i class="icon-2x icon-file"></i>
					</span>
				</td>

				<td data-ng-class="{true:'sorted', false:''}[DL.isSortedOn('label')]" ng-if="! DL.isPreview(doc)">
					<!--a class="pull-right" href data-ng-href="(= doc | documentURL =)" title="Éditer les propriétés">
						<i class="icon-edit icon-large"></i>
					</a-->
					<a data-ng-show="doc.is('Change_Website_StaticPage')" title="Éditer le contenu de la page"
					   href ng-href="(= doc | documentURL:'editor' =)">(=doc.label=)</a>
					<a data-ng-show="doc.is('Change_Website_Topic')" title="Naviguer vers le contenu de la rubrique"
					   href ng-href="(= doc | documentURL:'tree' =)">(=doc.label=)</a>

					<div>
						<small>
							<a href="javascript:" ng-click="DL.preview($index)">
								<i ng-if="doc.__DL_preview_loading" class="icon-spinner icon-spin"></i>
								<i ng-if="!doc.__DL_preview_loading" ng-class="{true: 'icon-circle-arrow-up', false: 'icon-circle-arrow-down'}[DL.hasPreview($index)]"></i>
								Aperçu</a> |
							<a href data-ng-href="(= doc | documentURL =)" title="Éditer les propriétés">Éditer</a>
						</small>
					</div>
				</td>
				<td data-ng-class="{true:'sorted', false:''}[DL.isSortedOn('modificationDate')]" ng-if="! DL.isPreview(doc)">
					(=doc.modificationDate | date:'medium'=)
				</td>
				<td style="text-align: right;" data-ng-class="{true:'sorted', false:''}[DL.isSortedOn('nodeOrder')]" ng-if="! DL.isPreview(doc)">
					(=doc.META$.treeNode.nodeOrder | number=)
				</td>
				<td data-ng-class="{true:'sorted', false:''}[DL.isSortedOn('activated')]" style="text-align: center;" ng-if="! DL.isPreview(doc)">
					<status-switch document="doc"/>
				</td>
			</tr>
		</tbody>
	</table>

	<footer class="row-fluid rbsc-list-footer" data-ng-show="DL.documents.length" data-mask="(=DL.loading=)">
		<div class="span2">
			<clipboard-add-widget selected="DL.selectedDocuments"></clipboard-add-widget>
		</div>
		<div class="span10">
			<pagination-toolbar document-list="DL" class="pull-right"></pagination-toolbar>
		</div>
	</footer>
</div>